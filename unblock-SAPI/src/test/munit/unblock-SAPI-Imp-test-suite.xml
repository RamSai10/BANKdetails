<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="unblock-SAPI-Imp-test-suite.xml" />
	<munit:test name="unblock-SAPI-Imp-test-suite-FetchingDetails-impFlowTest" doc:id="605318c8-49e4-4442-a32b-147c47097b48" description="Test">
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="64ccd1a3-2335-4c78-bc2b-05bfb7aff282" >
				<munit:attributes value='#[{queryParams:{accountNum:"0123456789"}}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to FetchingDetails-impFlow" doc:id="62e619d0-fe23-484d-9cd9-fd420a04534f" name="FetchingDetails-impFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="06fa36c1-4ab3-406a-9791-dc712346aa40" is="#[MunitTools::notNullValue()]" expression="#[payload]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="unblock-SAPI-Imp-test-suite-wrongpinUpdateSys-impFlowTest" doc:id="9d3a85e0-e94d-4a35-8849-d7a06f10feb4" description="Test">
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="d8da8f3b-7727-44ed-bc07-51468270961d" >
				<munit:payload value='#[{"custAccNum": "0123456789",&#10;	"AccountStatus":  "active",&#10;	"wrongPin": 0&#10;	&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to wrongpinUpdateSys-impFlow" doc:id="21e48c14-07b9-4355-8013-3c8a9e3affe7" name="wrongpinUpdateSys-impFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="eafe9bd0-f2c1-4f30-adf8-e91be816e058" is="#[MunitTools::notNullValue()]" expression="#[payload]"/>
		</munit:validation>
	</munit:test>

<munit:test name="fetchError-SAPI-Imp-test-suite-wrongpinUpdateSys-impFlowTest" doc:id="d15421e1-ee74-40aa-855f-9801d016a0b8" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="6e527b1c-0c9b-4b77-a9a2-1427d259f8f3" processor="db:select">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="830517d8-df18-4dd9-a951-24bf4f0e258f" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="ANY" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution>
			<try doc:name="Try" doc:id="7994fe4d-3301-4c0f-811b-e43b4cc03bb7" >
				<flow-ref doc:name="Flow-ref to wrongpinUpdateSys-impFlow" doc:id="0e45472b-2377-47a0-9023-cebb3de67ff2" name="FetchingDetails-impFlow" />
				<error-handler >
					<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="ead96215-d093-44b7-98c6-cc16d32c9947" >
						<logger level="INFO" doc:name="Logger" doc:id="aba728da-f0ff-4385-a812-97fd3ad3b84b" message='#["fail"]'/>
					</on-error-continue>
				</error-handler>
			</try>

		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="36f7e7e6-c9d5-4e74-948f-3ebe05c575cf" is='#[MunitTools::equalTo("DATABASE ERROR")]' expression="#[payload.error]"/>
		</munit:validation>
	</munit:test>


<munit:test name="updateError-SAPI-Imp-test-suite-wrongpinUpdateSys-impFlowTest" doc:id="87d9f591-df04-49ce-9df4-b16ed0af3d82" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="a953f559-80db-40f0-8cf6-b501fc4c732b" processor="db:update">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="e17bed50-0aff-403f-a730-9edb3263da36" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="ANY" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution>
			<try doc:name="Try" doc:id="7a2fd2df-0ad7-4d18-8926-c2f49f623543" >
				<flow-ref doc:name="Flow-ref to wrongpinUpdateSys-impFlow" doc:id="7b723ece-30c6-4550-8274-fee6147d3458" name="wrongpinUpdateSys-impFlow" />
				<error-handler >
					<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="1aea02af-4a3a-4430-b341-30fa491279c7" >
						<logger level="INFO" doc:name="Logger" doc:id="ea80574f-5842-4de3-951c-033b051d7907" message='#["fail"]'/>
					</on-error-continue>
				</error-handler>
			</try>

		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="2d41864d-44ac-440f-a9df-d800f354b863" is='#[MunitTools::equalTo("DATABASE ERROR")]' expression="#[payload.error]"/>
		</munit:validation>
	</munit:test>

</mule>
